<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•°æ®ç®¡ç† - æ¸¸æˆæ•°æ®åº“</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            color: white;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .nav-bar {
            background: white;
            border-radius: 12px;
            padding: 15px 20px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-bar a {
            color: #667eea;
            text-decoration: none;
            font-weight: bold;
            transition: color 0.3s;
        }

        .nav-bar a:hover {
            color: #5568d3;
        }

        .card {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .card h2 {
            color: #667eea;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 500;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            font-size: 1em;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            outline: none;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            border-color: #667eea;
        }

        .form-group textarea {
            min-height: 120px;
            font-family: inherit;
            resize: vertical;
        }

        .form-help {
            font-size: 0.85em;
            color: #666;
            margin-top: 5px;
        }

        .button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: background 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .button:hover {
            background: #5568d3;
        }

        .button-success {
            background: #28a745;
        }

        .button-success:hover {
            background: #218838;
        }

        .button-secondary {
            background: #6c757d;
        }

        .button-secondary:hover {
            background: #5a6268;
        }

        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .preview-box {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }

        .preview-box h3 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .preview-content {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            word-break: break-all;
            max-height: 300px;
            overflow-y: auto;
        }

        .current-fields {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }

        .field-tag {
            background: #e7f3ff;
            color: #0066cc;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.9em;
        }

        .command-box {
            background: #2d2d2d;
            color: #f8f8f2;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }

        .command-box h3 {
            color: #f92672;
            margin-bottom: 15px;
        }

        .command-content {
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            line-height: 1.6;
        }

        .hidden {
            display: none;
        }

        .loading {
            text-align: center;
            color: white;
            font-size: 1.2em;
            padding: 40px;
        }

        .success-message {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 8px;
            padding: 15px;
            color: #155724;
            margin-top: 15px;
        }

        .error-message {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 8px;
            padding: 15px;
            color: #721c24;
            margin-top: 15px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
        }

        .tab {
            padding: 10px 20px;
            background: #f8f9fa;
            border: none;
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            font-size: 1em;
            color: #666;
            transition: all 0.3s;
        }

        .tab.active {
            background: #667eea;
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>âš™ï¸ æ•°æ®ç®¡ç†</h1>

        <!-- å¯¼èˆªæ  -->
        <div class="nav-bar">
            <span>ğŸ® æ¸¸æˆæ•°æ®åº“ç®¡ç†åå°</span>
            <div>
                <a href="index.html">æ¸¸æˆåˆ—è¡¨</a> |
                <a href="updates.html">æ›´æ–°æ—¥å¿—</a>
            </div>
        </div>

        <!-- æ·»åŠ /æ›´æ–°æ•°æ® -->
        <div class="card">
            <h2>ğŸ“ æ·»åŠ /æ›´æ–°æ¸¸æˆæ•°æ®</h2>

            <div class="tabs">
                <button class="tab active" onclick="switchTab('add')">æ·»åŠ æ•°æ®</button>
                <button class="tab" onclick="switchTab('batch')">æ‰¹é‡æ·»åŠ </button>
            </div>

            <!-- æ·»åŠ å•ä¸ªæ•°æ® -->
            <div id="tab-add" class="tab-content active">
                <div class="form-group">
                    <label for="gameSelect">é€‰æ‹©æ¸¸æˆ</label>
                    <select id="gameSelect" onchange="loadGameData()">
                        <option value="">æ­£åœ¨åŠ è½½æ¸¸æˆåˆ—è¡¨...</option>
                    </select>
                    <div class="form-help">å½“å‰æ¸¸æˆçš„æ‰€æœ‰å­—æ®µå°†åœ¨ä¸‹æ–¹æ˜¾ç¤º</div>
                </div>

                <div id="currentFieldsBox" class="hidden">
                    <div class="form-group">
                        <label>å½“å‰å­—æ®µåˆ—è¡¨</label>
                        <div id="currentFields" class="current-fields"></div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="fieldName">å­—æ®µåç§°</label>
                    <input type="text" id="fieldName" placeholder="ä¾‹å¦‚: Så¿ã€Aè½¦ã€æ­¦å™¨ã€çš®è‚¤ç­‰" list="existingFields">
                    <datalist id="existingFields"></datalist>
                    <div class="form-help">è¾“å…¥ç°æœ‰å­—æ®µåæˆ–åˆ›å»ºæ–°å­—æ®µ</div>
                </div>

                <div class="form-group">
                    <label for="fieldValue">å­—æ®µå€¼ï¼ˆæ”¯æŒå¤šä¸ªï¼‰</label>
                    <textarea id="fieldValue" placeholder="æ¯è¡Œä¸€ä¸ªå€¼ï¼Œä¾‹å¦‚ï¼š&#10;æ–°è§’è‰²A&#10;æ–°è§’è‰²B&#10;æ–°è§’è‰²C"></textarea>
                    <div class="form-help">æ¯è¡Œè¾“å…¥ä¸€ä¸ªå€¼ï¼Œæ”¯æŒä¸€æ¬¡æ·»åŠ å¤šä¸ª</div>
                </div>

                <div class="button-group">
                    <button class="button button-success" onclick="addData()">â• æ·»åŠ æ•°æ®</button>
                    <button class="button button-secondary" onclick="clearForm()">æ¸…ç©ºè¡¨å•</button>
                </div>
            </div>

            <!-- æ‰¹é‡æ·»åŠ  -->
            <div id="tab-batch" class="tab-content">
                <div class="form-group">
                    <label for="batchGameSelect">é€‰æ‹©æ¸¸æˆ</label>
                    <select id="batchGameSelect" onchange="loadBatchGameData()">
                        <option value="">æ­£åœ¨åŠ è½½æ¸¸æˆåˆ—è¡¨...</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="batchData">æ‰¹é‡æ•°æ®ï¼ˆJSONæ ¼å¼ï¼‰</label>
                    <textarea id="batchData" placeholder='{
  "Så¿": "æ–°è§’è‰²A",
  "Aå¿": "æ–°è§’è‰²B",
  "çš®è‚¤": ["çš®è‚¤1", "çš®è‚¤2", "çš®è‚¤3"]
}'></textarea>
                    <div class="form-help">ä½¿ç”¨JSONæ ¼å¼ï¼Œæ”¯æŒå•ä¸ªå€¼æˆ–æ•°ç»„</div>
                </div>

                <div class="button-group">
                    <button class="button button-success" onclick="batchAddData()">ğŸ“¦ æ‰¹é‡æ·»åŠ </button>
                    <button class="button" onclick="loadBatchTemplate()">åŠ è½½æ¨¡æ¿</button>
                </div>
            </div>

            <!-- é¢„è§ˆåŒºåŸŸ -->
            <div id="previewBox" class="hidden">
                <div class="preview-box">
                    <h3>ğŸ“‹ æ›´æ–°é¢„è§ˆ</h3>
                    <div id="previewContent" class="preview-content"></div>
                </div>
            </div>

            <!-- ä¸‹è½½åŒºåŸŸ -->
            <div id="downloadBox" class="hidden">
                <div class="button-group" style="margin-top: 20px;">
                    <button class="button button-success" onclick="downloadJSON()">ğŸ“¥ ä¸‹è½½æ›´æ–°åçš„JSON</button>
                    <button class="button" onclick="downloadPythonScript()">ğŸ ä¸‹è½½Pythonè„šæœ¬</button>
                </div>
            </div>

            <!-- Gitå‘½ä»¤åŒºåŸŸ -->
            <div id="commandBox" class="hidden">
                <div class="command-box">
                    <h3>ğŸ’» Gitæäº¤å‘½ä»¤</h3>
                    <div id="commandContent" class="command-content"></div>
                </div>
            </div>

            <!-- æ¶ˆæ¯åŒºåŸŸ -->
            <div id="messageBox"></div>
        </div>

        <!-- ä½¿ç”¨è¯´æ˜ -->
        <div class="card">
            <h2>ğŸ“– ä½¿ç”¨è¯´æ˜</h2>
            <div style="color: #666; line-height: 1.8;">
                <p><strong>1. æ·»åŠ æ•°æ®æµç¨‹ï¼š</strong></p>
                <ul style="margin-left: 20px; margin-bottom: 15px;">
                    <li>é€‰æ‹©è¦æ›´æ–°çš„æ¸¸æˆ</li>
                    <li>è¾“å…¥å­—æ®µåç§°ï¼ˆå¦‚ï¼šSå¿ã€æ­¦å™¨ã€çš®è‚¤ç­‰ï¼‰</li>
                    <li>è¾“å…¥è¦æ·»åŠ çš„å€¼ï¼ˆæ¯è¡Œä¸€ä¸ªï¼‰</li>
                    <li>ç‚¹å‡»"æ·»åŠ æ•°æ®"é¢„è§ˆæ›´æ–°</li>
                    <li>ä¸‹è½½æ›´æ–°åçš„JSONæ–‡ä»¶æˆ–Pythonè„šæœ¬</li>
                </ul>

                <p><strong>2. æ›´æ–°åˆ°GitHubï¼š</strong></p>
                <ul style="margin-left: 20px; margin-bottom: 15px;">
                    <li>æ–¹æ³•1ï¼šä¸‹è½½JSONæ–‡ä»¶ï¼Œæ›¿æ¢æœ¬åœ°æ–‡ä»¶åæäº¤</li>
                    <li>æ–¹æ³•2ï¼šä¸‹è½½Pythonè„šæœ¬ï¼Œè¿è¡Œåè‡ªåŠ¨æ›´æ–°</li>
                    <li>ä½¿ç”¨æä¾›çš„Gitå‘½ä»¤æäº¤æ›´æ”¹</li>
                </ul>

                <p><strong>3. æ³¨æ„äº‹é¡¹ï¼š</strong></p>
                <ul style="margin-left: 20px;">
                    <li>æ‰€æœ‰æ·»åŠ éƒ½ä¼šè‡ªåŠ¨å»é‡</li>
                    <li>æ›´æ–°ä¼šè‡ªåŠ¨è®°å½•åˆ°updates.json</li>
                    <li>å»ºè®®å…ˆé¢„è§ˆå†ä¸‹è½½</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        let allGames = [];
        let currentGameData = null;
        let currentGameFile = null;
        let updatedGameData = null;

        // åŠ è½½æ¸¸æˆåˆ—è¡¨
        async function loadGamesList() {
            try {
                const response = await fetch('games.json');
                if (!response.ok) throw new Error('æ— æ³•åŠ è½½æ¸¸æˆåˆ—è¡¨');
                const games = await response.json();
                allGames = games;

                // æ›´æ–°ä¸¤ä¸ªä¸‹æ‹‰æ¡†
                const options = '<option value="">è¯·é€‰æ‹©æ¸¸æˆ...</option>' +
                    games.map(g => `<option value="${g.file}">${g.icon} ${g.name}</option>`).join('');

                document.getElementById('gameSelect').innerHTML = options;
                document.getElementById('batchGameSelect').innerHTML = options;
            } catch (error) {
                console.error('åŠ è½½æ¸¸æˆåˆ—è¡¨å¤±è´¥:', error);
                showMessage('æ— æ³•åŠ è½½æ¸¸æˆåˆ—è¡¨', 'error');
            }
        }

        // åˆ‡æ¢æ ‡ç­¾é¡µ
        function switchTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));

            event.target.classList.add('active');
            document.getElementById(`tab-${tab}`).classList.add('active');
        }

        // åŠ è½½æ¸¸æˆæ•°æ®
        async function loadGameData() {
            const gameFile = document.getElementById('gameSelect').value;
            if (!gameFile) {
                document.getElementById('currentFieldsBox').classList.add('hidden');
                currentGameData = null;
                currentGameFile = null;
                return;
            }

            try {
                const response = await fetch(gameFile);
                if (!response.ok) throw new Error('æ— æ³•åŠ è½½æ•°æ®æ–‡ä»¶');
                const data = await response.json();
                currentGameData = data;
                currentGameFile = gameFile;

                // æ˜¾ç¤ºå½“å‰å­—æ®µ
                const fields = Object.keys(data);
                document.getElementById('currentFields').innerHTML =
                    fields.map(f => `<span class="field-tag">${f}</span>`).join('');
                document.getElementById('currentFieldsBox').classList.remove('hidden');

                // æ›´æ–°datalist
                document.getElementById('existingFields').innerHTML =
                    fields.map(f => `<option value="${f}">`).join('');
            } catch (error) {
                console.error('åŠ è½½æ¸¸æˆæ•°æ®å¤±è´¥:', error);
                showMessage('æ— æ³•åŠ è½½æ¸¸æˆæ•°æ®', 'error');
            }
        }

        // æ·»åŠ æ•°æ®
        function addData() {
            if (!currentGameData || !currentGameFile) {
                showMessage('è¯·å…ˆé€‰æ‹©æ¸¸æˆ', 'error');
                return;
            }

            const fieldName = document.getElementById('fieldName').value.trim();
            const fieldValue = document.getElementById('fieldValue').value.trim();

            if (!fieldName) {
                showMessage('è¯·è¾“å…¥å­—æ®µåç§°', 'error');
                return;
            }

            if (!fieldValue) {
                showMessage('è¯·è¾“å…¥å­—æ®µå€¼', 'error');
                return;
            }

            // å¤åˆ¶æ•°æ®
            updatedGameData = JSON.parse(JSON.stringify(currentGameData));

            // åˆ›å»ºå­—æ®µï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
            if (!updatedGameData[fieldName]) {
                updatedGameData[fieldName] = [];
            }

            // æ·»åŠ å€¼
            const values = fieldValue.split('\n').map(v => v.trim()).filter(v => v);
            const added = [];
            const skipped = [];

            values.forEach(v => {
                if (!updatedGameData[fieldName].includes(v)) {
                    updatedGameData[fieldName].push(v);
                    added.push(v);
                } else {
                    skipped.push(v);
                }
            });

            // æ˜¾ç¤ºé¢„è§ˆ
            showPreview(fieldName, added, skipped);
            showMessage(`æˆåŠŸæ·»åŠ  ${added.length} ä¸ªå€¼${skipped.length > 0 ? `ï¼Œè·³è¿‡ ${skipped.length} ä¸ªé‡å¤å€¼` : ''}`, 'success');

            // æ˜¾ç¤ºä¸‹è½½å’Œå‘½ä»¤åŒºåŸŸ
            document.getElementById('downloadBox').classList.remove('hidden');
            document.getElementById('commandBox').classList.remove('hidden');

            // ç”ŸæˆGitå‘½ä»¤
            generateCommands(fieldName, added);
        }

        // æ˜¾ç¤ºé¢„è§ˆ
        function showPreview(fieldName, added, skipped) {
            const preview = {
                game: currentGameFile.replace('.json', ''),
                field: fieldName,
                added: added,
                skipped: skipped,
                totalInField: updatedGameData[fieldName].length
            };

            document.getElementById('previewContent').textContent = JSON.stringify(preview, null, 2);
            document.getElementById('previewBox').classList.remove('hidden');
        }

        // ç”ŸæˆGitå‘½ä»¤
        function generateCommands(fieldName, added) {
            const gameName = currentGameFile.replace('.json', '');
            const timestamp = new Date().toISOString().replace('T', ' ').substring(0, 19);
            const valueStr = added.length === 1 ? added[0] : `${added.length}ä¸ªæ–°å€¼`;

            const command = `# 1. ä¸‹è½½JSONæ–‡ä»¶å¹¶æ›¿æ¢æœ¬åœ°æ–‡ä»¶
# 2. è¿è¡Œä»¥ä¸‹å‘½ä»¤æäº¤åˆ°GitHub

git add ${currentGameFile} updates.json
git commit -m "Update ${gameName}: ${fieldName} - ${valueStr}"
git push`;

            document.getElementById('commandContent').textContent = command;
        }

        // ä¸‹è½½JSON
        function downloadJSON() {
            if (!updatedGameData) return;

            const jsonStr = JSON.stringify(updatedGameData, ensureUnicode, 2);
            const blob = new Blob([jsonStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);

            const a = document.createElement('a');
            a.href = url;
            a.download = currentGameFile;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            // åŒæ—¶ç”Ÿæˆå¹¶ä¸‹è½½æ›´æ–°æ—¥å¿—
            downloadUpdateLog();
        }

        // ç¡®ä¿ä¸­æ–‡æ­£ç¡®æ˜¾ç¤º
        function ensureUnicode(key, value) {
            return value;
        }

        // ä¸‹è½½æ›´æ–°æ—¥å¿—
        async function downloadUpdateLog() {
            try {
                const response = await fetch('updates.json');
                const updates = await response.json();

                const fieldName = document.getElementById('fieldName').value.trim();
                const fieldValue = document.getElementById('fieldValue').value.trim();
                const values = fieldValue.split('\n').map(v => v.trim()).filter(v => v);
                const gameName = currentGameFile.replace('.json', '');

                // åˆ›å»ºæ–°çš„æ›´æ–°è®°å½•
                const newUpdate = {
                    time: new Date().toLocaleString('zh-CN', { hour12: false }).replace(/\//g, '-'),
                    game: gameName,
                    updates: {}
                };

                // æ£€æŸ¥å“ªäº›å€¼æ˜¯æ–°æ·»åŠ çš„
                const addedValues = values.filter(v => !currentGameData[fieldName]?.includes(v));
                if (addedValues.length > 0) {
                    newUpdate.updates[fieldName] = addedValues.length === 1 ? addedValues[0] : `${addedValues.length}ä¸ªæ–°å€¼`;
                }

                // æ·»åŠ åˆ°æ›´æ–°æ—¥å¿—å¼€å¤´
                updates.unshift(newUpdate);

                // ä¸‹è½½æ›´æ–°æ—¥å¿—
                const jsonStr = JSON.stringify(updates.slice(0, 100), ensureUnicode, 2);
                const blob = new Blob([jsonStr], { type: 'application/json' });
                const url = URL.createObjectURL(blob);

                const a = document.createElement('a');
                a.href = url;
                a.download = 'updates.json';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            } catch (error) {
                console.error('ä¸‹è½½æ›´æ–°æ—¥å¿—å¤±è´¥:', error);
            }
        }

        // ä¸‹è½½Pythonè„šæœ¬
        function downloadPythonScript() {
            if (!updatedGameData) return;

            const fieldName = document.getElementById('fieldName').value.trim();
            const fieldValue = document.getElementById('fieldValue').value.trim();
            const values = fieldValue.split('\n').map(v => v.trim()).filter(v => v);
            const addedValues = values.filter(v => !currentGameData[fieldName]?.includes(v));
            const gameName = currentGameFile.replace('.json', '');

            const script = `#!/usr/bin/env python3
# -*- coding: utf-8 -*-
\"\"\"
è‡ªåŠ¨æ›´æ–°è„šæœ¬ - ç”Ÿæˆäº ${new Date().toLocaleString('zh-CN')}
æ¸¸æˆ: ${gameName}
å­—æ®µ: ${fieldName}
\"\"\"
import json

def update_game_data():
    json_file = "${currentGameFile}"

    # è¯»å–ç°æœ‰æ•°æ®
    try:
        with open(json_file, 'r', encoding='utf-8') as f:
            data = json.load(f)
    except FileNotFoundError:
        print(f"[ERROR] æ–‡ä»¶ä¸å­˜åœ¨: {json_file}")
        return

    # ç¡®ä¿å­—æ®µå­˜åœ¨
    if "${fieldName}" not in data:
        data["${fieldName}"] = []

    # æ·»åŠ æ–°å€¼
    new_values = ${JSON.stringify(addedValues)}
    added = 0
    for value in new_values:
        if value and value not in data["${fieldName}"]:
            data["${fieldName}"].append(value)
            added += 1
            print(f"[OK] ${gameName} - ${fieldName}: {value}")

    # ä¿å­˜æ•°æ®
    with open(json_file, 'w', encoding='utf-8') as f:
        json.dump(data, f, ensure_ascii=False, indent=2)

    print(f"\\n[SUCCESS] å·²æ·»åŠ  {added} ä¸ªæ–°å€¼")

    # æ›´æ–°æ—¥å¿—
    try:
        with open('updates.json', 'r', encoding='utf-8') as f:
            updates = json.load(f)
    except:
        updates = []

    from datetime import datetime
    update_log = {
        "time": datetime.now().strftime('%Y-%m-%d %H:%M:%S'),
        "game": "${gameName}",
        "updates": {
            "${fieldName}": "${addedValues.length === 1 ? addedValues[0] : addedValues.length + 'ä¸ªæ–°å€¼'}"
        }
    }
    updates.insert(0, update_log)

    with open('updates.json', 'w', encoding='utf-8') as f:
        json.dump(updates[:100], f, ensure_ascii=False, indent=2)

    print("[SUCCESS] æ›´æ–°æ—¥å¿—å·²è®°å½•")
    print("\\nè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤æäº¤åˆ°GitHub:")
    print('  git add ${currentGameFile} updates.json')
    print('  git commit -m "Update ${gameName}: ${fieldName}"')
    print("  git push")

if __name__ == "__main__":
    update_game_data()
`;

            const blob = new Blob([script], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);

            const a = document.createElement('a');
            a.href = url;
            a.download = `update_${gameName}_${fieldName}.py`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // æ¸…ç©ºè¡¨å•
        function clearForm() {
            document.getElementById('fieldName').value = '';
            document.getElementById('fieldValue').value = '';
            document.getElementById('previewBox').classList.add('hidden');
            document.getElementById('downloadBox').classList.add('hidden');
            document.getElementById('commandBox').classList.add('hidden');
            document.getElementById('messageBox').innerHTML = '';
            updatedGameData = null;
        }

        // æ˜¾ç¤ºæ¶ˆæ¯
        function showMessage(text, type) {
            const className = type === 'success' ? 'success-message' : 'error-message';
            document.getElementById('messageBox').innerHTML = `<div class="${className}">${text}</div>`;
        }

        // æ‰¹é‡æ·»åŠ 
        async function loadBatchGameData() {
            const gameFile = document.getElementById('batchGameSelect').value;
            // å¯ä»¥åœ¨è¿™é‡Œé¢„åŠ è½½æ¸¸æˆæ•°æ®ç”¨äºéªŒè¯
        }

        function batchAddData() {
            showMessage('æ‰¹é‡æ·»åŠ åŠŸèƒ½å¼€å‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…', 'error');
        }

        function loadBatchTemplate() {
            const template = {
                "å­—æ®µå1": "å•ä¸ªå€¼",
                "å­—æ®µå2": ["å€¼1", "å€¼2", "å€¼3"],
                "å­—æ®µå3": ["å¯ä»¥ä¸€æ¬¡æ·»åŠ å¤šä¸ªå€¼"]
            };
            document.getElementById('batchData').value = JSON.stringify(template, null, 2);
        }

        // åˆå§‹åŒ–
        window.onload = loadGamesList;
    </script>
</body>
</html>
